<div [class]="htmlClass"
  [class.has-feedback]="layoutNode?.feedback !== false && isInputWidget && formControl?.dirty"
  [class.has-error]="!layoutNode?.disableErrorState && formControl?.errors && formControl?.dirty"
  [class.has-success]="!layoutNode?.disableSuccessState && !formControl?.errors && formControl?.dirty">

  <button *ngIf="isRemovable" (click)="removeItem()" class="close pull-right"
    style="position: relative; z-index: 20;" type="button">
    <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
  </button>
  <div *ngIf="messageLocation === 'top'">
    <p *ngIf="!layoutNode?.disableErrorState && layoutNode?.feedback !== false && errorMessage && formControl?.dirty"
      [innerHTML]="errorMessage" class="help-block"></p>
    <p *ngIf="layoutNode?.feedback !== false && formControl?.dirty"
      [id]="layoutNode?.pointer + 'Status'" class="sr-only"
      [innerHTML]="formControl?.errors ? '(error)' : '(success)'"></p>
    <p *ngIf="layoutNode?.description" [innerHTML]="layoutNode?.description" class="help-block"></p>
    <p *ngIf="layoutNode?.help" [innerHTML]="layoutNode?.help" class="help-block"></p>
  </div>

  <label [attr.for]="layoutNode?.pointer" [class]="labelHtmlClass"
    [class.sr-only]="layoutNode?.notitle || !title" [innerHTML]="title"></label>
  <strong *ngIf="title && layoutNode?.required" class="text-danger">*</strong>
  <p *ngIf="layoutNode?.type === 'submit' && formOptions?.fieldsRequired">
    <strong class="text-danger">*</strong> = required fields
  </p>
  <div [class.input-group]="layoutNode?.fieldAddonLeft || layoutNode?.fieldAddonRight">
    <span *ngIf="layoutNode?.fieldAddonLeft" class="input-group-addon"
      [innerHTML]="layoutNode?.fieldAddonLeft"></span>

    <div #widgetContainer></div>

    <span *ngIf="layoutNode?.fieldAddonRight" class="input-group-addon"
      [innerHTML]="layoutNode?.fieldAddonRight"></span>
  </div>

  <span *ngIf="layoutNode?.feedback !== false && isInputWidget &&
    !layoutNode?.fieldAddonRight && !layoutNode.isArrayItem && formControl?.dirty"
    [class.glyphicon-ok]="!layoutNode?.disableSuccessState && !formControl?.errors"
    [class.glyphicon-remove]="!layoutNode?.disableErrorState && formControl?.errors"
    aria-hidden="true" class="form-control-feedback glyphicon"></span>
  <div *ngIf="messageLocation === 'bottom'">
    <p *ngIf="!layoutNode?.disableErrorState && layoutNode?.feedback !== false && errorMessage && formControl?.dirty"
      [innerHTML]="errorMessage" class="help-block"></p>
    <p *ngIf="layoutNode?.feedback !== false && formControl?.dirty" [id]="layoutNode?.pointer + 'Status'"
      [innerHTML]="formControl?.errors ? '(error)' : '(success)'" class="sr-only"></p>
    <p *ngIf="layoutNode?.description" [innerHTML]="layoutNode?.description" class="help-block"></p>
    <p *ngIf="layoutNode?.help" [innerHTML]="layoutNode?.help" class="help-block"></p>
  </div>
</div>

<div *ngIf="debug && debugOutput">debug: <pre *ngIf="debug">{{debugOutput}}</pre></div>
