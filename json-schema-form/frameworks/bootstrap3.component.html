<div [class]="htmlClass"
  [class.list-group]="layoutNode?.type === 'array'"
  [class.list-group-item]="layoutNode?.isArrayItem && layoutNode?.type !== '$ref'"
  [class.has-success]="!layoutNode?.disableSuccessState && formControl?.dirty && !formControl?.errors"
  [class.has-error]="!layoutNode?.disableErrorState && formControl?.dirty && formControl?.errors"
  [class.has-feedback]="layoutNode?.feedback !== false && formControl?.dirty">
  <button *ngIf="layoutNode?.isArrayItem && layoutNode?.type !== '$ref' &&
    !layoutNode?.readonly && layoutNode?.remove !== false"
    style="position: relative; z-index: 20;" type="button"
    class="close pull-right" (click)="deleteFromArray()">
    <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
  </button>
  <div *ngIf="messageLocation === 'top'">
    <p *ngIf="!layoutNode?.disableErrorState && layoutNode?.feedback !== false && formControl?.dirty && errorMessage"
      [innerHTML]="errorMessage" class="help-block"></p>
    <span *ngIf="layoutNode?.feedback !== false && formControl?.dirty"
      [innerHTML]="formControl?.errors ? '(error)' : '(success)'" class="sr-only"></span>
    <p *ngIf="layoutNode?.description"
      [innerHTML]="layoutNode?.description" class="help-block"></p>
    <p *ngIf="layoutNode?.help"
      [innerHTML]="layoutNode?.help" class="help-block"></p>
  </div>

  <div [ngSwitch]="controlView">

    <!-- Single checkboxes -->
    <div *ngSwitchCase="'checkbox'">
      <label [class.sr-only]="layoutNode?.notitle" [class]="labelHtmlClass"
        [attr.for]="layoutNode?.pointer">
        <div #widgetContainer></div> <span [innerHTML]="title"></span>
      </label>
    </div>

    <!-- Default: All other controls -->
    <div *ngSwitchDefault>
      <label *ngIf="title" [innerHTML]="title" [attr.for]="layoutNode?.pointer"
        [class.sr-only]="layoutNode?.notitle" [class]="labelHtmlClass"></label>
      <strong *ngIf="layoutNode?.required" class="text-danger">*</strong>
      <p *ngIf="layoutNode?.type === 'submit' && formOptions?.fieldsRequired">
        <strong class="text-danger">*</strong> = required fields
      </p>
      <div [class.input-group]="layoutNode?.fieldAddonLeft || layoutNode?.prepend ||
        layoutNode?.fieldAddonRight || layoutNode?.append">
        <span *ngIf="layoutNode?.fieldAddonLeft || layoutNode?.prepend"
          [innerHTML]="layoutNode?.fieldAddonLeft || layoutNode?.prepend"
          class="input-group-addon"></span>

        <div #widgetContainer></div>

        <span *ngIf="layoutNode?.fieldAddonRight || layoutNode?.append"
          [innerHTML]="layoutNode?.fieldAddonRight || layoutNode?.append"
          class="input-group-addon"></span>
      </div>
    </div>

  </div>

  <div *ngIf="messageLocation === 'bottom'">
    <!-- <span *ngIf="layoutNode?.feedback !== false && formControl?.dirty"
      [class.glyphicon-ok]="!layoutNode?.disableSuccessState && !formControl?.errors"
      [class.glyphicon-remove]="!layoutNode?.disableErrorState && formControl?.errors"
      class="glyphicon form-control-feedback" aria-hidden="true"></span>
    <span *ngIf="layoutNode?.feedback !== false && formControl?.dirty"
      [id]="layoutNode?.pointer + 'Status'" class="sr-only">
      {{formControl?.errors ? '(error)' : '(success)'}} </span> -->
    <p *ngIf="!layoutNode?.disableErrorState && layoutNode?.feedback !== false && formControl?.dirty && errorMessage"
      [innerHTML]="errorMessage" class="help-block"></p>
      <span id="inputSuccess2Status" class="sr-only">(success)</span>
    <p *ngIf="layoutNode?.description"
      [innerHTML]="layoutNode?.description" class="help-block"></p>
    <p *ngIf="layoutNode?.help"
      [innerHTML]="layoutNode?.help" class="help-block"></p>
  </div>
</div>

<div *ngIf="debug && debugOutput">debug: <pre *ngIf="debug">{{debugOutput}}</pre></div>
